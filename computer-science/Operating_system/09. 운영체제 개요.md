---
tags:
  - operating_system
---
#### 운영체제(operating system)
실행할 프로그램에 필요한 자원[^1]을 할당하고, 프로그램이 올바르게 실행되도록 돕는 특별한 프로그램

운영체제 또한 다른 프로그램과 마찬가지로 메모리에 적재되어야 하는데 항상 컴퓨터가 부팅될 때 메모리 내 커널 영역(kernal space)에 적재되어 실행된다.
커널 영역을 제외한 나머지 영역, 사용자가 이용하는 응용 프로그램[^2]이 적재되는 영역을 사용자 영역(user space)라고 한다.

운영체제의 역할
- 메모리 주소가 겹치지 않도록 적당한 공간에 프로그램들을 적재
- 지속적으로 메모리 자원을 관리
- 최대한 공정하게 여러 프로그램에 CPU 자원을 할당
- 응용 프로그램과 하드웨어 사이에서 응용 프로그램에 필요한 자원을 할당

---
#### 커널(kernal)
운영체제의 핵심 서비스를 담당하는 부분

> [!note]- 커널에 포함되지 않는 운영체제 서비스
> 사용자 인터페이스(UI, UserInterface)는 커널에 포함되지 않는 서비스 중 대표적인 서비스이다.
> 실제로 같은 커널을 사용하더라도 사용자 인터페이스는 다를 수 있다.

***
#### 이중 모드와 시스템 호출
운영체제는 사용자가 실행하는 응용 프로그램이 하드웨어 자원에 직접 접근하는 것을 방지한다. 응용 프로그램들이 자원에 접근하려고 할 때 ==오직 운영체제를 통해서만 접근하도록 하여 자원을 보호==한다.
만약 응용 프로그램이 자원에 마음대로 접근하고 조작할 수 있다면 자원이 무질서하게 관리될 것이고, 응용 프로그램이 조금만 실수해도 컴퓨터 전체에 큰 악영향을 끼칠 수 있다.
이중 모드(dual mode)란 CPU가 명령어를 실행하는 모드를 크게 <span style="color:rgb(218, 195, 137)">사용자 모드와 커널 모드로 구분하는 방식</span>이다.

**사용자 모드(user mode)**
운영체제 서비스를 제공 받을 수 없는 실행 모드이다. 즉, 커널 영역의 코드를 실행할 수 없는 모드이다.
일반적인 응용 프로그램은 기본적으로 사용자 모드로 실행된다.
사용자 모드로 실행 중인 CPU는 하드웨어 자원에 접근하는 명령어를 실행할 수 없으므로, 사용자 모드로 실행되는 일반적인 응용 프로그램은 자원에 접근할 수 없다.

**커널 모드(kernal mode)**
운영체제 서비스를 제공 받을 수 있는 실행 모드이다. 즉, 커널 영역의 코드를 실행할 수 있는 모드이다.
CPU가 커널 모드로 명령어를 실행하면 자원에 접근하는 명령어를 비롯한 모든 명령어 실행할 수 있다.

> [!question] CPU가 어떤 이중 모드인지 확인하는 방법
> 플래그 레지스터 속 슈퍼바이저 플래그를 보면 알 수 있다.

**시스템 호출(system call)**
사용자 모드로 실행되는 프로그램이 자원에 접근하는 운영체제 서비스를 제공받으려면 운영체제에 요청을 보내 커널 모드로 전환되어야 한다.
이때 운영체제 서비스를 제공받기 위한 요청을 시스템 호출(시스템 콜)이라고 한다.

시스템 호출은 일종의 소프트웨어적인 인터럽트(interrupt)다.[^3]
시스템 호출을 발생시키는 명령어가 실행되면 CPU는 지금까지의 작업을 백업하고, 커널 영역 내에 시스템 호출을 수행하는 코드(인터럽트 서비스 루틴)을 실행한 뒤 다시 기존에 실행하던 응용 프로그램으로 복귀하여 실행을 계속해 나간다.

![[인터럽트#^interrupt01]]

> [!note]- POSIX 운영체제(유닉스, 리눅스 등의 운영체제)에서 사용하는 대표적 시스템 호출의 종류
> ``` tx
> | 종류        | 시스템 호출    | 설명                                   |
> | --------- | --------- | ------------------------------------ |
> | 프로세스 관리   | fork()    | 새 자식 프로세스 생성                         |
> | ^         | execve()  | 프로세스 실행(메모리 공간을 새로운 프로그램의 내용으로 덮어씌움) |
> | ^         | exit()    | 프로세스 종료                              |
> | ^         | waitpid() | 자식 프로세스가 종료할 때까지 대기                  |
> | 파일 관리     | open()    | 파일 열기                                |
> | ^         | calse()   | 파일 닫기                                |
> | ^         | read()    | 파일 읽기                                |
> | ^         | write()   | 파일 쓰기                                |
> | ^         | stat()    | 파일 정보 획득                             |
> | 디렉터리 관리   | chdir()   | 작업 디렉터리 변경                           |
> | ^         | mkdir()   | 디렉터리 생성                              |
> | ^         | rmdir()   | 비어 있는 디렉터리 삭제                        |
> | 파일 시스템 관리 | mount()   | 파일 시스템 마운트                           |
> | ^         | unmount() | 파일 시스템 마운트 해제                        |
> ```


***
#### 운영체제의 핵심 서비스
##### 프로세스 관리
\[10장 프로세스 관리 및 실행]
\[12장 프로세스 동기화]
\[13장 교착 상태]

##### 자원 접근 및 할당
###### CPU
\[\[11장 CPU 스케줄링]]
###### 메모리
\[14장 메모리 관리]
###### 입출력 장치
입출력 장치가 CPU에 하드웨어 인터럽트 요청 신호를 보내면 CPU는 하던 일을 잠시 백업한 뒤 커널 영역에 있는 인터럽트 서비스 루틴을 실행한다.

##### 파일 시스템 관리
\[15장 보조기억장치]

***
#### 가상 머신과 이중 모드
가상 머신(virtual machine)이란 소프트웨어적으로 만들어낸 가상 컴퓨터이다.
운영체제에서 가상 머신을 설치 및 실행한다면, 그 가상 머신 또한 응용 프로그램이다. 마찬가지로 가상 머신상에 설치된 운영체제 또한 사용자 모드로 작동한다.
가상 머신 상에서 작동하는 응용 프로그램들이 가상 머신에 설치된 운영체제로부터 운영체제 서비스를 제공받기 위해 가상화를 지원하는 CPU는 이중 모드 외에 가상 머신을 위한 모드인 하이퍼바이저 모드를 따로 둔다.

> [!note]- 하이퍼바이저(Hypervisor)
> 출처: [[하이퍼바이저란 무엇일까? Hypervisor 개념 알아보기 :: JD Securtiry Expert](https://jdcyber.tistory.com/66)]


[^1]: 시스템 자원: 프로그램 실행에 마땅히 필요한 요소들 (ex. CPU, 메모리, 보조기억장치, 입출력장치 등)
[^2]: 응용 프로그램(application software): 사용자가 특정 목적을 위해 사용하는 일반적인 프로그램
[^3]: 소프트웨어 인터럽트(software interrupt): 특정 명령어에 의해 발생하는 인터럽트